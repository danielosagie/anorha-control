[Sandbox] Navigated to: http://the-internet.herokuapp.com/inputs

ğŸ“ Episode 11
   Site: http://the-internet.herokuapp.com/inputs
   Task: Type numbers into the input field
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['Type numbers into the input field']...

   Step 1/5: click Type numbers into the input field
   âš ï¸ VLM target not found - using input_fallback: (640, 150)
   âŒ¨ï¸ Type 'John Doe' @ (640, 150)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)

   Step 2/5: Type numbers into the input field
   âš ï¸ VLM target not found - using input_fallback: (640, 150)
   âŒ¨ï¸ Type 'hello world' @ (640, 150)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)

   Step 3/5: Type numbers into the input field
   âš ï¸ VLM target not found - using input_fallback: (640, 150)

âœ… Data saved to: D:\danie\Documents\Code Projects\anorha-control\data\experiences.db
ğŸ“Š Final stats:
  Total actions: 5079
  Successes: 855
  Unique states: 0
  Success rate: 16.8%
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "D:\danie\Documents\Code Projects\anorha-control\anorha_control\main.py", line 368, in <module>
    main()
  File "D:\danie\Documents\Code Projects\anorha-control\anorha_control\main.py", line 313, in main
    asyncio.run(run_explore(args))
  File "C:\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\danie\Documents\Code Projects\anorha-control\anorha_control\main.py", line 137, in run_explore
    await explorer.explore_forever()
  File "D:\danie\Documents\Code Projects\anorha-control\anorha_control\exploration\sandbox_explorer.py", line 696, in explore_forever
    await self._close_browser()
  File "D:\danie\Documents\Code Projects\anorha-control\anorha_control\exploration\sandbox_explorer.py", line 200, in _close_browser
    await self._browser.close()
  File "D:\danie\Documents\Code Projects\anorha-control\.venv\Lib\site-packages\playwright\async_api\_generated.py", line 14322, in close
    return mapping.from_maybe_impl(await self._impl_obj.close(reason=reason))
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\danie\Documents\Code Projects\anorha-control\.venv\Lib\site-packages\playwright\_impl\_browser.py", line 241, in close
    raise e
  File "D:\danie\Documents\Code Projects\anorha-control\.venv\Lib\site-packages\playwright\_impl\_browser.py", line 238, in close
    await self._channel.send("close", None, {"reason": reason})
  File "D:\danie\Documents\Code Projects\anorha-control\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 69, 
in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\danie\Documents\Code Projects\anorha-control\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
Exception: Browser.close: Connection closed while reading from the driver

danie@Br MINGW64 /d/danie/Documents/Code Projects/anorha-control (main)
$ uv run python -m anorha_control.main explore --headless --planner-model qwen2.5-vl:7b
============================================================
ğŸ–±ï¸  ANORHA-CONTROL: Real Mouse Explorer
============================================================
Device: cpu

Loading vision encoder...
[Vision] Loading SigLIP2: google/siglip2-base-patch16-224
Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
The image processor of type `SiglipImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`.
Loading weights: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 408/408 [00:00<00:00, 1787.85it/s, Materializing param=vision_model.post_layernorm.weight]
[Vision] SigLIP2 loaded successfully: 768d
[Vision] Encoder ready: 768d output, temporal=0
  Vision encoder: 768d output (temporal=0)
Loading TRM...
  TRM: 9,513,992 params

Database: data\experiences.db

Config:
  Epsilon: 0.3
  Steps per episode: 10

âš ï¸  WARNING: This will control your REAL mouse!
   Press Cmd+Shift+Escape at any time to STOP
   Press Cmd+Shift+P to PAUSE/RESUME

   Starting in 3 seconds...

Initializing planner: qwen2.5-vl:7b

ğŸ”’ Running in SANDBOX mode - your mouse is free!

============================================================
ğŸ”’ ANORHA-CONTROL: Sandbox Explorer Active
   Browser-only mode - your mouse is free!
   Press Cmd+Shift+Escape to stop
   Press Cmd+Shift+P to pause/resume
============================================================
[Border] Green border activated (#8cc63f)
[KillSwitch] Listening for <ctrl>+<shift>+<esc>
[PauseSwitch] Listening for <ctrl>+<shift>+p

ğŸ“Š Training Estimates:
   Basic proficiency: 10,000-20,000 experiences
   High accuracy: 50,000-100,000 experiences
[Sandbox] Browser initialized with ad blocking
[Sandbox] Navigated to: https://testsheepnz.github.io/BasicCalculator.html

ğŸ“ Episode 1
   Site: https://testsheepnz.github.io/BasicCalculator.html
   Task: Solve: (25 * 4) - 17 = ?
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['Solve: (25 * 4) - 17 = ?']...

   Step 1/5: click Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using trm: (590, 645)
   ğŸ–±ï¸ Click @ (590, 645)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 2/5: Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using element: (908, 51)
   ğŸ–±ï¸ Click @ (908, 51)
   âœ“ reward=0.80 (dist_r=0.00 vis_r=0.80)

   Step 3/5: Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using element: (221, 3243)
   ğŸ–±ï¸ Click @ (221, 3243)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 4/5: Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using element: (252, 1243)
   ğŸ–±ï¸ Click @ (252, 1243)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)

   Step 5/5: Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using element: (131, 52)
   ğŸ–±ï¸ Click @ (131, 52)
   âœ“ reward=0.80 (dist_r=0.00 vis_r=0.80)
[Sandbox] Navigated to: https://bookcart.azurewebsites.net/
   ğŸ¯ Strategic planning (GLM)...
[StrategicPlanner] Generation error: HTTPConnectionPool(host='localhost', port=11434): Read timed out. (read timeout=60.0)
   ğŸ“‹ Strategy: 3 steps

ğŸ“ Episode 2
   Site: https://bookcart.azurewebsites.net/
   Task: Search for a book, add to cart, proceed to checkout
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['search field', 'search field', 'search button']...

   Step 1/5: click search field
   âš ï¸ VLM target not found - using random: (207, 484)
   ğŸ–±ï¸ Click @ (207, 484)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 2/5: type search field
   âš ï¸ VLM target not found - using input_match: (541, 32)
   âŒ¨ï¸ Type 'hello world' @ (541, 32)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 3/5: click search button
   âš ï¸ VLM target not found - using trm: (535, 548)
   ğŸ–±ï¸ Click @ (535, 548)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)
   âš ï¸ 3 consecutive failures - ending episode
[Sandbox] Navigated to: https://demoqa.com/automation-practice-form

ğŸ“ Episode 3
   Site: https://demoqa.com/automation-practice-form
   Task: Fill out the complete registration form and submit
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['Fill out the complete registration form and submit']...

   Step 1/5: click Fill out the complete registration form and submit
   âš ï¸ VLM target not found - using input_match: (580, 574)
   âŒ¨ï¸ Type 'John Doe' @ (580, 574)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 2/5: Fill out the complete registration form and submit
   âš ï¸ VLM target not found - using input_match: (839, 574)
   âŒ¨ï¸ Type 'New York' @ (839, 574)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 3/5: Fill out the complete registration form and submit
   âš ï¸ VLM target not found - using input_match: (709, 620)
   âŒ¨ï¸ Type 'John Doe' @ (709, 620)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)
   âš ï¸ 3 consecutive failures - ending episode

ğŸ“Š Progress: 5090 actions, 2/11 successes
[Sandbox] Navigated to: https://practice.expandtesting.com/

ğŸ“ Episode 4
   Site: https://practice.expandtesting.com/
   Task: Complete various form types
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['Complete various form types']...

   Step 1/5: click Complete various form types
   âš ï¸ VLM target not found - using input_match: (564, 755)
   âŒ¨ï¸ Type 'test@example.com' @ (564, 755)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 2/5: Complete various form types
   âš ï¸ VLM target not found - using random: (160, 89)
   âŒ¨ï¸ Type 'New York' @ (160, 89)
   âœ“ reward=0.80 (dist_r=0.00 vis_r=0.80)

   Step 3/5: Complete various form types
   âš ï¸ VLM target not found - using input_match: (564, 125)
   âŒ¨ï¸ Type 'John Doe' @ (564, 125)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 4/5: Complete various form types
   âš ï¸ VLM target not found - using input_fallback: (564, 125)
   âŒ¨ï¸ Type 'test@example.com' @ (564, 125)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 5/5: Complete various form types
   âš ï¸ VLM target not found - using input_fallback: (564, 125)
   âŒ¨ï¸ Type 'test@example.com' @ (564, 125)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)
[Sandbox] Navigated to: https://testsheepnz.github.io/BasicCalculator.html

ğŸ“ Episode 5
   Site: https://testsheepnz.github.io/BasicCalculator.html
   Task: Solve: (25 * 4) - 17 = ?
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['Solve: (25 * 4) - 17 = ?']...

   Step 1/5: click Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using random: (1040, 1678)
   ğŸ–±ï¸ Click @ (1040, 1678)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)

   Step 2/5: Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using element: (1124, 51)
   ğŸ–±ï¸ Click @ (1124, 51)
   âœ“ reward=0.80 (dist_r=0.00 vis_r=0.80)

   Step 3/5: Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using element: (492, 174)
   ğŸ–±ï¸ Click @ (492, 174)
   âœ“ reward=0.80 (dist_r=0.00 vis_r=0.80)

   Step 4/5: Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using element: (382, 8365)
   ğŸ–±ï¸ Click @ (382, 8365)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 5/5: Solve: (25 * 4) - 17 = ?
   âš ï¸ VLM target not found - using random: (545, 4271)
   ğŸ–±ï¸ Click @ (545, 4271)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)
[Sandbox] Navigated to: https://practice.expandtesting.com/inputs

ğŸ“ Episode 6
   Site: https://practice.expandtesting.com/inputs
   Task: Fill out various input types including textarea
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['Fill out various input types including textarea']...

   Step 1/5: click Fill out various input types including textarea
   âš ï¸ VLM target not found - using input_match: (330, 918)
   âŒ¨ï¸ Type 'New York' @ (330, 918)
   âœ“ reward=0.80 (dist_r=0.00 vis_r=0.80)

   Step 2/5: Fill out various input types including textarea
   âš ï¸ VLM target not found - using input_match: (330, 288)
   âŒ¨ï¸ Type 'hello world' @ (330, 288)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 3/5: Fill out various input types including textarea
   âš ï¸ VLM target not found - using input_match: (330, 288)
   âŒ¨ï¸ Type '123 Main St' @ (330, 288)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 4/5: Fill out various input types including textarea
   âš ï¸ VLM target not found - using input_match: (330, 288)
   âŒ¨ï¸ Type 'New York' @ (330, 288)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)
   âš ï¸ 3 consecutive failures - ending episode

ğŸ“Š Progress: 5104 actions, 6/25 successes
[Sandbox] Navigated to: https://www.saucedemo.com/

ğŸ“ Episode 7
   Site: https://www.saucedemo.com/
   Task: Login with username 'standard_user' and password 'secret_sauce'
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['username field', 'username field', 'password field', 'password field', 'login button']...

   Step 1/7: click username field
   âš ï¸ VLM target not found - using random: (640, 173)
   ğŸ–±ï¸ Click @ (640, 173)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 2/7: type username field
   âš ï¸ VLM target not found - using random: (640, 173)
   âŒ¨ï¸ Type 'New York' @ (640, 173)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 3/7: click password field
   âš ï¸ VLM target not found - using random: (640, 227)
   ğŸ–±ï¸ Click @ (640, 227)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)
   âš ï¸ 3 consecutive failures - ending episode
[Sandbox] Navigated to: http://the-internet.herokuapp.com/

ğŸ“ Episode 8
   Site: http://the-internet.herokuapp.com/
   Task: Navigate to 'Form Authentication' and login with tomsmith/SuperSecretPassword!
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['username field', 'username field', 'password field', 'password field', 'login button']...

   Step 1/7: click username field
   âš ï¸ VLM target not found - using random: (187, 642)
   ğŸ–±ï¸ Click @ (187, 642)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 2/7: type username field
   âš ï¸ VLM target not found - using input_fallback: (640, 146)
   âŒ¨ï¸ Type 'John Doe' @ (640, 146)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 3/7: click password field
   âš ï¸ VLM target not found - using random: (640, 146)
   ğŸ–±ï¸ Click @ (640, 146)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)
   âš ï¸ 3 consecutive failures - ending episode
[Sandbox] Navigated to: https://testsheepnz.github.io/BasicCalculator.html

ğŸ“ Episode 9
   Site: https://testsheepnz.github.io/BasicCalculator.html
   Task: Solve: 42 + 13 = ?
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['Solve: 42 + 13 = ?']...

   Step 1/5: click Solve: 42 + 13 = ?
   âš ï¸ VLM target not found - using trm: (692, 684)
   ğŸ–±ï¸ Click @ (692, 684)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)

   Step 2/5: Solve: 42 + 13 = ?
   âš ï¸ VLM target not found - using element: (1040, 1678)
   ğŸ–±ï¸ Click @ (1040, 1678)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)

   Step 3/5: Solve: 42 + 13 = ?
   âš ï¸ VLM target not found - using random: (153, 51)
   ğŸ–±ï¸ Click @ (153, 51)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)
   âš ï¸ 3 consecutive failures - ending episode

ğŸ“Š Progress: 5113 actions, 6/34 successes
[Sandbox] Navigated to: https://www.saucedemo.com/

ğŸ“ Episode 10
   Site: https://www.saucedemo.com/
   Task: Login with username 'standard_user' and password 'secret_sauce'
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['username field', 'username field', 'password field', 'password field', 'login button']...

   Step 1/7: click username field
   âš ï¸ VLM target not found - using random: (640, 227)
   ğŸ–±ï¸ Click @ (640, 227)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)

   Step 2/7: type username field
   âš ï¸ VLM target not found - using input_match: (640, 173)
   âŒ¨ï¸ Type '123 Main St' @ (640, 173)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)

   Step 3/7: click password field
   âš ï¸ VLM target not found - using input_match: (640, 227)
   ğŸ–±ï¸ Click @ (640, 227)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)
   âš ï¸ 3 consecutive failures - ending episode
[Sandbox] Navigated to: http://uitestingplayground.com/textinput

ğŸ“ Episode 11
   Site: http://uitestingplayground.com/textinput
   Task: Type a new button name and click the button to change its text
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['target element']...

   Step 1/5: click target element
   âš ï¸ VLM target not found - using trm: (627, 720)
   ğŸ–±ï¸ Click @ (627, 720)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)

   Step 2/5: Type a new button name and click the button to change its text
   âš ï¸ VLM target not found - using input_fallback: (640, 400)
   âŒ¨ï¸ Type '123 Main St' @ (640, 400)
   âœ— reward=0.00 (dist_r=0.00 vis_r=0.00)

   Step 3/5: Type a new button name and click the button to change its text
   âš ï¸ VLM target not found - using input_fallback: (640, 400)
   âŒ¨ï¸ Type 'John Doe' @ (640, 400)
   âœ— reward=0.30 (dist_r=0.00 vis_r=0.30)
   âš ï¸ 3 consecutive failures - ending episode
[Sandbox] Navigated to: https://practice.expandtesting.com/

ğŸ“ Episode 12
   Site: https://practice.expandtesting.com/
   Task: Complete various form types
   ğŸ§  VLM Planning...
   ğŸ“ Plan: ['Complete various form types']...

   Step 1/5: click Complete various form types
   âš ï¸ VLM target not found - using input_match: (564, 755)
   âŒ¨ï¸ Type 'test@example.com' @ (564, 755)

âŒ Error: Page.screenshot: Timeout 30000ms exceeded.
Call log:
  - taking page screenshot

Traceback (most recent call last):
  File "D:\danie\Documents\Code Projects\anorha-control\anorha_control\exploration\sandbox_explorer.py", line 668, in explore_forever
    await self.explore_episode()
  File "D:\danie\Documents\Code Projects\anorha-control\anorha_control\exploration\sandbox_explorer.py", line 537, in explore_episode
    after_img = await self._screenshot()
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\danie\Documents\Code Projects\anorha-control\anorha_control\exploration\sandbox_explorer.py", line 206, in _screenshot
    screenshot_bytes = await self._page.screenshot()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\danie\Documents\Code Projects\anorha-control\.venv\Lib\site-packages\playwright\async_api\_generated.py", line 9792, in screenshot
    await self._impl_obj.screenshot(
  File "D:\danie\Documents\Code Projects\anorha-control\.venv\Lib\site-packages\playwright\_impl\_page.py", line 814, in screenshot
    encoded_binary = await self._channel.send(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\danie\Documents\Code Projects\anorha-control\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\danie\Documents\Code Projects\anorha-control\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TimeoutError: Page.screenshot: Timeout 30000ms exceeded.
Call log:
  - taking page screenshot